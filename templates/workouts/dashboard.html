{% extends "base.html" %} {% block title %}Dashboard - Fitness Tracker{%
endblock %} {% block content %}
<div class="row">
  <div class="col-12">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2><i class="bi bi-speedometer2"></i> My Workouts</h2>
      <a
        href="{{ url_for('workouts.new_workout') }}"
        class="btn"
        style="background-color: #001f3f; color: white"
      >
        <i class="bi bi-plus-circle"></i> Add New Workout
      </a>
    </div>

    <!-- Upcoming Scheduled Workouts -->
    {% if upcoming_workouts %}
    <div
      class="card mb-4"
      style="background-color: #1a1a1a; border-color: #001f3f"
    >
      <div class="card-header" style="background-color: #001f3f; color: white">
        <h5 class="mb-0">
          <i class="bi bi-calendar-check"></i> Upcoming Workouts (Next 7 Days)
        </h5>
      </div>
      <div class="card-body">
        <div class="list-group list-group-flush">
          {% for scheduled in upcoming_workouts %}
          <div
            class="list-group-item d-flex justify-content-between align-items-center"
            style="background-color: #2a2a2a; border-color: #3a3a3a"
          >
            <div>
              <h6 class="mb-1">
                <i
                  class="bi bi-{{ 'check-circle-fill text-success' if scheduled.completed else 'circle' }}"
                ></i>
                {{ scheduled.get_name() }} {% if scheduled.custom_workout %}
                <span class="badge bg-info">Custom</span>
                {% endif %}
              </h6>
              <small class="text-muted">
                <i class="bi bi-calendar3"></i> {{
                scheduled.scheduled_date.strftime('%A, %B %d, %Y') }} {% if
                scheduled.notes %} <br /><i class="bi bi-sticky"></i> {{
                scheduled.notes[:50] + '...' if scheduled.notes|length > 50 else
                scheduled.notes }} {% endif %}
              </small>
            </div>
            <div>
              {% if scheduled.custom_workout %}
              <a
                href="{{ url_for('custom_workouts.view_custom_workout', id=scheduled.custom_workout_id) }}"
                class="btn btn-sm btn-outline-info"
                title="View Details"
              >
                <i class="bi bi-eye"></i>
              </a>
              {% endif %}
              <a
                href="{{ url_for('schedule.schedule') }}"
                class="btn btn-sm btn-outline-light"
                title="Go to Schedule"
              >
                <i class="bi bi-calendar3"></i>
              </a>
              {% if scheduled.completed %}
              <form
                method="POST"
                action="{{ url_for('schedule.incomplete_scheduled_workout', id=scheduled.id) }}"
                style="display: inline"
              >
                <button
                  type="submit"
                  class="btn btn-sm btn-outline-warning"
                  title="Mark as Not Complete"
                >
                  <i class="bi bi-x-circle"></i>
                </button>
              </form>
              {% else %}
              <form
                method="POST"
                action="{{ url_for('schedule.complete_scheduled_workout', id=scheduled.id) }}"
                style="display: inline"
              >
                <button
                  type="submit"
                  class="btn btn-sm btn-outline-success"
                  title="Mark as Complete"
                >
                  <i class="bi bi-check-circle"></i>
                </button>
              </form>
              {% endif %}
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
    {% endif %}

    <!-- Past Workouts History -->
    <h4 class="mb-3"><i class="bi bi-clock-history"></i> Workout History</h4>

    {% if workouts %}
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead class="table-dark">
          <tr>
            <th>Date</th>
            <th>Exercise</th>
            <th>Duration (min)</th>
            <th>Calories</th>
            <th>Notes</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for workout in workouts %}
          <tr>
            <td>{{ workout.date.strftime('%Y-%m-%d') }}</td>
            <td><strong>{{ workout.exercise }}</strong></td>
            <td>{{ workout.duration }}</td>
            <td>{{ workout.calories }}</td>
            <td>
              {{ workout.notes[:50] + '...' if workout.notes and
              workout.notes|length > 50 else workout.notes }}
            </td>
            <td>
              <a
                href="{{ url_for('workouts.edit_workout', id=workout.id) }}"
                class="btn btn-sm btn-warning"
              >
                <i class="bi bi-pencil"></i>
              </a>
              <form
                method="POST"
                action="{{ url_for('workouts.delete_workout', id=workout.id) }}"
                style="display: inline"
              >
                <button
                  type="submit"
                  class="btn btn-sm btn-danger"
                  onclick="return confirm('Are you sure you want to delete this workout?');"
                >
                  <i class="bi bi-trash"></i>
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="alert alert-info text-center">
      <i class="bi bi-info-circle"></i> No workouts recorded yet.
      <a href="{{ url_for('workouts.new_workout') }}" class="alert-link"
        >Add your first workout</a
      >!
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
