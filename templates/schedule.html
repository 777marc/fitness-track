{% extends "base.html" %} {% block title %}Weekly Schedule - Fitness Tracker{%
endblock %} {% block content %}
<div class="row">
  <div class="col-12">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2><i class="bi bi-calendar-week"></i> Weekly Workout Schedule</h2>
      <a
        href="{{ url_for('add_scheduled_workout') }}"
        class="btn"
        style="background-color: #001f3f; color: white"
      >
        <i class="bi bi-plus-circle"></i> Schedule Workout
      </a>
    </div>

    <!-- Week Navigation -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <a
        href="{{ url_for('schedule', week=week_offset-1) }}"
        class="btn btn-outline-secondary"
      >
        <i class="bi bi-chevron-left"></i> Previous Week
      </a>
      <h5 class="mb-0">
        {{ week_dates[0].strftime('%B %d') }} - {{ week_dates[6].strftime('%B
        %d, %Y') }}
      </h5>
      <a
        href="{{ url_for('schedule', week=week_offset+1) }}"
        class="btn btn-outline-secondary"
      >
        Next Week <i class="bi bi-chevron-right"></i>
      </a>
    </div>

    <!-- Weekly Calendar View -->
    <div class="row">
      {% set day_names = ['Monday', 'Tuesday', 'Wednesday', 'Thursday',
      'Friday', 'Saturday', 'Sunday'] %} {% for date in week_dates %}
      <div class="col-md-12 col-lg-6 col-xl-4 mb-4">
        <div class="card h-100 {% if date == today %}border-primary{% endif %}">
          <div
            class="card-header {% if date == today %}bg-primary text-white{% else %}bg-light{% endif %}"
          >
            <h6 class="mb-0">
              <strong>{{ day_names[loop.index0] }}</strong>
              <span class="float-end">{{ date.strftime('%m/%d') }}</span>
            </h6>
          </div>
          <div class="card-body">
            {% if workouts_by_date[date] %} {% for workout in
            workouts_by_date[date] %}
            <div
              class="card mb-2 {% if workout.completed %}bg-light{% endif %}"
            >
              <div class="card-body p-2">
                <div class="d-flex justify-content-between align-items-start">
                  <div class="flex-grow-1">
                    <h6
                      class="mb-1 {% if workout.completed %}text-decoration-line-through text-muted{% endif %}"
                    >
                      <i
                        class="bi bi-{{ 'check-circle-fill text-success' if workout.completed else 'circle' }}"
                      ></i>
                      {{ workout.get_name() }} {% if workout.custom_workout %}
                      <span class="badge bg-info text-dark ms-1">Custom</span>
                      {% endif %}
                    </h6>
                    {% if workout.workout_type and
                    workout.workout_type.default_duration %}
                    <small class="text-muted">
                      <i class="bi bi-clock"></i> {{
                      workout.workout_type.default_duration }} min
                    </small>
                    {% elif workout.custom_workout %}
                    <small class="text-muted">
                      <i class="bi bi-list-ol"></i> {{
                      workout.custom_workout.exercises|length }} exercises
                    </small>
                    {% endif %} {% if workout.notes %}
                    <p class="mb-0 small text-muted">
                      {{ workout.notes[:50] }}...
                    </p>
                    {% endif %}
                  </div>
                  <div class="btn-group btn-group-sm ms-2" role="group">
                    {% if workout.custom_workout %}
                    <a
                      href="{{ url_for('view_custom_workout', id=workout.custom_workout.id) }}"
                      class="btn btn-sm"
                      style="background-color: #001f3f; color: white"
                      title="View workout details"
                    >
                      <i class="bi bi-eye"></i>
                    </a>
                    {% endif %} {% if not workout.completed %}
                    <form
                      method="POST"
                      action="{{ url_for('complete_scheduled_workout', id=workout.id) }}"
                      style="display: inline"
                    >
                      <button
                        type="submit"
                        class="btn btn-sm btn-success"
                        title="Mark as complete"
                      >
                        <i class="bi bi-check"></i>
                      </button>
                    </form>
                    {% endif %}
                    <form
                      method="POST"
                      action="{{ url_for('delete_scheduled_workout', id=workout.id) }}"
                      style="display: inline"
                    >
                      <button
                        type="submit"
                        class="btn btn-sm btn-danger"
                        onclick="return confirm('Delete this scheduled workout?');"
                        title="Delete"
                      >
                        <i class="bi bi-trash"></i>
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %} {% else %}
            <p class="text-muted mb-0 text-center">
              <i class="bi bi-calendar-x"></i><br />
              No workouts scheduled
            </p>
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="mt-3">
      <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Back to Dashboard
      </a>
    </div>
  </div>
</div>
{% endblock %}
